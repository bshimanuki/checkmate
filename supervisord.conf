[supervisord]
nodaemon = true

[fcgi-program:asgi]
socket = tcp://localhost:8000
directory = /app/backend
command = daphne -u /run/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers checkmate.asgi:application
numprocs = 4
process_name = asgi%(process_num)d
autostart = true
autorestart = true
stdout_logfile = /log/asgi.stdout.log
stdout_logfile_maxbytes = 999999
stdout_logfile_backups = 10
stderr_logfile = /log/asgi.stderr.log
stderr_logfile_maxbytes = 999999
stderr_logfile_backups = 10

[program:fan_root]
directory = /app/backend
command = python manage.py runworker fan_root
autostart = true
autorestart = true
stdout_logfile = /log/fan_root.stdout.log
stdout_logfile_maxbytes = 999999
stdout_logfile_backups = 10
stderr_logfile = /log/fan_root.stderr.log
stderr_logfile_maxbytes = 999999
stderr_logfile_backups = 10

[program:celery]
directory = /app/backend
command = celery -A checkmate worker -n worker_%(process_num)d
process_name = celery-%(process_num)d
numprocs = 1
autostart = true
autorestart = true
stdout_logfile = /log/celery.stdout.log
stdout_logfile_maxbytes = 999999
stdout_logfile_backups = 10
stderr_logfile = /log/celery.stderr.log
stderr_logfile_maxbytes = 999999
stderr_logfile_backups = 10
